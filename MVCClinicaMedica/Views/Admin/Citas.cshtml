@model List<Cita>
@{
    ViewData["Title"] = "Citas";
}
@{
    var listMedicos = (List<Medico>)ViewData["Medicos"];
    var listPacientes = (List<Paciente>)ViewData["Pacientes"];
    var listPagos = (List<TipoPago>)ViewData["TipoPagos"];
}

<div class="container mt-5">
    <h1 class="text-center">Citas</h1>
    <div class="container mt-3">
        <h3 class="mb-3">Lista de citas</h3>
        <a asp-controller="Admin" asp-action="CrearCita" class="btn btn-success mb-3"><i class="fas fa-plus-circle"></i> Crear Cita</a>

        @if (Model.Count() > 0)
        {
            <table class="table table-bordered table-primary">
                <thead class="table-primary">
                    <tr class="text-center">
                        <th>Fecha de la Cita</th>
                        <th>Nombre Medico</th>
                        <th>Nombre Paciente</th>
                        <th>Paciente Cedula</th>
                        <th>Descripcion</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody class="table-primary">
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.Fecha</td>
                            <td>@listMedicos.FirstOrDefault(m => m.idMedico == item.idMedico)?.Nombre</td>
                            <td>@listPacientes.FirstOrDefault(m => m.idPaciente == item.idPaciente)?.Nombre</td>
                            <td>@listPacientes.FirstOrDefault(m => m.idPaciente == item.idPaciente)?.Cedula</td>
                            <td>@listPagos.FirstOrDefault(m => m.idTipoPago == item.idTipoPago)?.Descripcion</td>
                            <td>
                                <div class="btn-group" role="group">
                                    <a asp-controller="Admin" asp-action="EditarCita" asp-route-fecha="@item.Fecha" asp-route-idCita="@item.idCita"
                                       asp-route-idPaciente="@item.idPaciente" asp-route-idMedico="@item.idMedico" asp-route-idTipoPago="@item.idTipoPago"
                                       class="btn btn-primary"><i class="fas fa-pencil-alt"></i> Editar</a>
                                    <a asp-controller="Admin" asp-action="EliminarCita" asp-route-id="@item.idCita" class="btn btn-danger"><i class="fas fa-trash"></i> Eliminar</a>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <p class="text-center">No existen registros.</p>
        }
    </div>
</div>
